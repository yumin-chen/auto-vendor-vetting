---
Status: Draft
Date: 2025-12-27
Authors: [Rust Platform]
Reviewers: [Security, Compliance, Control Plane]
Requirements:
  Addressed:
    - Generate complete SBOMs in **SPDX 2.3 JSON** and **CycloneDX 1.4 JSON** formats
    - Include all dependency information, i.e., name, version, source, licenses
    - Represent Rust-specific metadata in namespaced annotations
    - Ensure reproducibility and determinism in generated SBOMs
    - Exclude vulnerability scoring or risk assessment
Related ADRs:
  - ADR-001: Cargo.lock as Source of Truth
  - ADR-002: Deterministic Output Principle
  - ADR-003: Offline-First Vendor Management
---

# ADR-004: SBOM Generation Without Vulnerability Scoring

## Context

The Rust Ecosystem Adapter produces Software Bill of Materials (SBOMs) to describe dependency relationships and metadata for Rust projects. SBOMs are consumed by the **Control Plane** for auditing, compliance, and security evaluation.

Vulnerability scoring and prioritization are the responsibility of the Control Plane; embedding these in SBOMs would **violate separation of concerns** and could result in inconsistent or duplicated security decisions across projects.

---

## Decision

The Rust Ecosystem Adapter will generate **component-only SBOMs** with full dependency metadata but **will not compute, embed, or infer vulnerability information**.

### Key Decisions

1. **SBOM Formats**:

   * SPDX JSON (2.3)
   * CycloneDX JSON (1.4)

2. **Included Metadata**:

   * Package name, version, source (registry, git, path)
   * License information
   * Features and dependency kind (normal, build, dev)
   * Rust-specific annotations (namespaced under `"rust"` key)

3. **Excluded Metadata**:

   * Vulnerability scoring (CVSS, severity, advisories)
   * Tool-specific risk assessment
   * Policy-based prioritization

4. **Determinism**:

   * Repeated SBOM generation from identical inputs produces byte-identical outputs
   * Rust annotations do not break Universal Dependency Graph (UDG) schema

5. **Control Plane Integration**:

   * Vulnerability and security evaluation delegated to the Control Plane
   * SBOMs are treated as canonical factual data

---

## Consequences

**Positive**:

* Clear separation of fact collection (adapter) from policy evaluation (Control Plane)
* Simplifies verification and reproducibility
* Ensures consistent SBOM output for auditing

**Negative**:

* Consumers of SBOMs must perform separate vulnerability analysis
* SBOMs alone do not provide actionable security prioritization

**Mitigations**:

* Provide integration hooks and artifacts for the Control Plane to consume raw SBOMs
* Include sufficient metadata to allow risk evaluation externally

---

## Alternatives Considered

1. **Include vulnerability scoring in SBOM**: Rejected

   * Violates separation of concerns
   * Risk of inconsistent scoring across projects

2. **Generate minimal SBOM with only package names and versions**: Rejected

   * Fails to capture sufficient metadata for licensing, auditing, or TCS classification

3. **Generate SBOM with partial advisory metadata**: Rejected

   * Partial advisories can mislead consumers
   * Reduces determinism and reproducibility

---
